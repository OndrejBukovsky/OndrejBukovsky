"use strict";Object.defineProperty(exports,"__esModule",{value:true});document.body.innerHTML=`<div class='parent'><div id='panel'class='panel child'><span class="wikiAppLink"onclick='loadFromServer("/.wikiresources/doc/readme.html")'><info><icon/>Readme page</info></span><br/><span class="wikiAppLink"onclick='loadFromServer("/.wikiresources/doc/tutorial.html")'><info><icon/>Usage</info></span><br/><span class="wikiAppLink"onclick='loadFromServer("/.wikiresources/doc/template.html")'><info><icon/>Template</info></span><br/><br/></div><button id='showPagesBtn'>Pages</button><div id='content'class='child content'><div id='loadingStatus'><div id='loadingStatusContainer'><div class='loading'></div></div></div><iframe id='iframeContent'scrolling='no'></iframe></div></div>`;const panel=document.getElementById("panel");const loadingStatus=document.getElementById("loadingStatus");const content=document.getElementById("iframeContent");const showPagesBtn=document.getElementById("showPagesBtn");function loadFromServer(path){if(serverRoot&&serverRoot!==""){path=serverRoot+path;}
const pathStrSplit=path.split('/');const fileName=pathStrSplit.pop();const directoryName=pathStrSplit.join('/');console.log(directoryName);fetch(directoryName+'/.resources').then(res=>{const resources=res.text();return resources;}).then(res=>{fetch(path).then(x=>{return x.text();}).then((html)=>{let htmlText=String(html);res.split("\n").forEach(r=>{htmlText=htmlText.replace(new RegExp('src="'+r+'"','g'),'src="'+directoryName+'/'+r+'"');});onStartLoading();content.src=path;});});panel.classList.remove("showMobileMenu");}
exports.loadFromServer=loadFromServer;function loadAll(){fetch('pages.json').then(res=>{const json=res.text();return json;}).then(json=>{let pages={};try{pages=JSON.parse(json);}
catch(e){console.log(e);}
loadDirectory(pages,panel);});}
exports.loadAll=loadAll;function loadDirectory(dir,parent){if(dir.Children){const ul=document.createElement("ul");if(dir.Name!=="__root__"){const li=document.createElement("li");li.innerHTML="<folder><icon/>"+dir.Name+"</folder>";parent.appendChild(li);li.appendChild(ul);}
else{ul.className="wikiTree";ul.id="wikiTreeRoot";parent.appendChild(ul);}
dir.Children.forEach((child)=>{loadDirectory(child,ul);});}
else{const li=document.createElement("li");li.innerHTML="<span class=\"wikiAppLink\" onclick='loadFromServer(\""+dir.Path+"\")'>"+dir.Name+"</span>";parent.appendChild(li);}}
exports.loadDirectory=loadDirectory;window.onmessage=(ev)=>{if(ev.data==="wikiAppLink.onclick"){onStartLoading();}};function onStartLoading(){loadingStatus.style.display="block";}
content.onload=()=>{content.style.height=(content.contentWindow.document.body.scrollHeight+20)+"px";const path=content.contentDocument.location.href.split("#");if(path.length==2){const element=content.contentDocument.getElementById(path[1]);if(element){element.scrollIntoView();}}
else{document.documentElement.scrollIntoView();}
loadingStatus.style.display="none";};showPagesBtn.onclick=()=>{panel.classList.toggle("showMobileMenu");};loadFromServer('/.wikiresources/doc/readme.html');loadAll();